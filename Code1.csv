"import sqlite3"
"import pandas as pd"
""
"# Connect to the SQLite database"
"conn = sqlite3.connect('database.db')"
"cursor = conn.cursor()"
""
"# SQL solution"
"sql_query = """""""
"SELECT CustomerID, Age, Item, SUM(Quantity) AS TotalQuantity"
"FROM Purchases"
"WHERE Age BETWEEN 18 AND 35"
"GROUP BY CustomerID, Item"
"HAVING TotalQuantity > 0"
""""""""
""
"cursor.execute(sql_query)"
"results_sql = cursor.fetchall()"
""
"# Pandas solution"
"df = pd.read_sql_query(""SELECT * FROM Purchases"", conn)"
"df_filtered = df[(df['Age'] >= 18) & (df['Age'] <= 35)]"
"df_grouped = df_filtered.groupby(['CustomerID', 'Item'])['Quantity'].sum().reset_index()"
"df_filtered_pandas = df_grouped[df_grouped['Quantity'] > 0]"
""
""
"# Close connection"
"conn.close()"
